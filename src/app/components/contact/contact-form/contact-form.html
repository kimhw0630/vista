<div class="flex flex-col">
  <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg border border-gray-100 dark:border-gray-700 p-6 md:p-10 sticky top-24">
    <div class="mb-8">
      <h2 class="text-2xl md:text-3xl font-bold mb-2">{{ 'contact.form.title' | translate }}</h2>
      <p class="text-slate-500 dark:text-slate-400">{{ 'contact.form.subtitle' | translate }}</p>
    </div>
    <form #contactForm="ngForm" class="flex flex-col gap-5" (ngSubmit)="onSubmit($event, contactForm)">
      <!-- Success/Error Message -->
      @if (submitMessage) {
        <div [class]="submitSuccess ? 'bg-green-50 dark:bg-green-900/20 text-green-800 dark:text-green-200 border border-green-200 dark:border-green-800' : 'bg-red-50 dark:bg-red-900/20 text-red-800 dark:text-red-200 border border-red-200 dark:border-red-800'" class="p-4 rounded-lg">
          {{ submitMessage }}
        </div>
      }
      
      <div class="grid grid-cols-1 md:grid-cols-2 gap-5">
        <div class="flex flex-col gap-2">
          <label class="text-sm font-semibold text-slate-700 dark:text-slate-200" for="fullName">{{ 'contact.form.name' | translate }}</label>
          <input #fullName="ngModel" class="w-full h-12 rounded-lg border border-gray-300 dark:border-gray-600 bg-gray-50 dark:bg-gray-900 px-4 text-slate-900 dark:text-white placeholder-slate-400 focus:border-primary focus:ring-1 focus:ring-primary focus:outline-none transition-all"
            id="fullName" name="fullName" [(ngModel)]="formData.fullName" [placeholder]="'contact.form.namePlaceholder' | translate" type="text" maxlength="100" required/>
          @if (fullName.invalid && fullName.touched) {
            <span class="text-xs text-red-600 dark:text-red-400">{{ 'contact.form.validation.nameRequired' | translate }}</span>
          }
        </div>
        <div class="flex flex-col gap-2">
          <label class="text-sm font-semibold text-slate-700 dark:text-slate-200" for="email">{{ 'contact.form.email' | translate }}</label>
          <input #email="ngModel" class="w-full h-12 rounded-lg border border-gray-300 dark:border-gray-600 bg-gray-50 dark:bg-gray-900 px-4 text-slate-900 dark:text-white placeholder-slate-400 focus:border-primary focus:ring-1 focus:ring-primary focus:outline-none transition-all"
            id="email" name="email" [(ngModel)]="formData.email" [placeholder]="'contact.form.emailPlaceholder' | translate" type="email" pattern="[a-z0-9._%+\-]+@[a-z0-9.\-]+\.[a-z]{2,}$" maxlength="255" required/>
          @if (email.invalid && email.touched) {
            <span class="text-xs text-red-600 dark:text-red-400">
              @if (email.errors?.['required']) {
                <span>{{ 'contact.form.validation.emailRequired' | translate }}</span>
              }
              @if (email.errors?.['pattern'] || email.errors?.['email']) {
                <span>{{ 'contact.form.validation.emailInvalid' | translate }}</span>
              }
            </span>
          }
        </div>
      </div>
      <div class="grid grid-cols-1 md:grid-cols-2 gap-5">
        <div class="flex flex-col gap-2">
          <label class="text-sm font-semibold text-slate-700 dark:text-slate-200" for="phone">{{ 'contact.form.phone' | translate }}</label>
          <input #phone="ngModel" class="w-full h-12 rounded-lg border border-gray-300 dark:border-gray-600 bg-gray-50 dark:bg-gray-900 px-4 text-slate-900 dark:text-white placeholder-slate-400 focus:border-primary focus:ring-1 focus:ring-primary focus:outline-none transition-all"
            id="phone" name="phone" [(ngModel)]="formData.phone" [placeholder]="'contact.form.phonePlaceholder' | translate" type="tel" maxlength="50" required/>
          @if (phone.invalid && phone.touched) {
            <span class="text-xs text-red-600 dark:text-red-400">{{ 'contact.form.validation.phoneRequired' | translate }}</span>
          }
        </div>
        <div class="flex flex-col gap-2">
          <label class="text-sm font-semibold text-slate-700 dark:text-slate-200" for="subject">{{ 'contact.form.subject' | translate }}</label>
          <select #subject="ngModel" class="w-full h-12 rounded-lg border border-gray-300 dark:border-gray-600 bg-gray-50 dark:bg-gray-900 px-4 text-slate-900 dark:text-white focus:border-primary focus:ring-1 focus:ring-primary focus:outline-none transition-all"
            id="subject" name="subject" [(ngModel)]="formData.subject" required>
            <option disabled selected value="">{{ 'contact.form.subjectPlaceholder' | translate }}</option>
            <option value="Corporate & Business">{{ 'contact.form.subjects.corporate' | translate }}</option>
            <option value="Real Estate">{{ 'contact.form.subjects.realEstate' | translate }}</option>
            <option value="Civil & Commercial Litigation">{{ 'contact.form.subjects.litigation' | translate }}</option>
            <option value="Employment Law">{{ 'contact.form.subjects.employment' | translate }}</option>
             <option value="Wills & Estates">{{ 'contact.form.subjects.wills' | translate }}</option>
              <option value="Dental / Health Law">{{ 'contact.form.subjects.dental' | translate }}</option>
               <option value="Referral Services">{{ 'contact.form.subjects.referral' | translate }}</option>
                <option value="Leasing">{{ 'contact.form.subjects.leasing' | translate }}</option>
                <option value="Immigration Law">{{ 'contact.form.subjects.immigration' | translate }}</option>
            <option value="Other">{{ 'contact.form.subjects.other' | translate }}</option>
          </select>
          @if (subject.invalid && subject.touched) {
            <span class="text-xs text-red-600 dark:text-red-400">{{ 'contact.form.validation.subjectRequired' | translate }}</span>
          }
        </div>
      </div>
      <div class="flex flex-col gap-2">
        <label class="text-sm font-semibold text-slate-700 dark:text-slate-200" for="message">{{ 'contact.form.message' | translate }}</label>
        <textarea class="w-full rounded-lg border border-gray-300 dark:border-gray-600 bg-gray-50 dark:bg-gray-900 px-4 py-3 text-slate-900 dark:text-white placeholder-slate-400 focus:border-primary focus:ring-1 focus:ring-primary focus:outline-none transition-all resize-none"
          id="message" name="message" [(ngModel)]="formData.message" [placeholder]="'contact.form.messagePlaceholder' | translate" rows="5" maxlength="2000"></textarea>
      </div>
      <div class="flex items-start gap-3 mt-2">
        <div class="flex h-6 items-center">
          <input #privacy="ngModel" class="h-4 w-4 rounded border-gray-300 text-primary focus:ring-primary dark:border-gray-600 dark:bg-gray-900"
            id="privacy" name="privacy" [(ngModel)]="privacyAccepted" type="checkbox" required/>
        </div>
        <div class="text-sm leading-6">
          <label class="font-medium text-slate-700 dark:text-slate-300" for="privacy">{{ 'contact.form.privacyLabel' | translate }} <a routerLink="/privacy-policy" class="text-primary hover:underline">{{ 'contact.form.privacyLink' | translate }}</a>.</label>
          <p class="text-slate-500 text-xs mt-1">{{ 'contact.form.privacyNote' | translate }}</p>
          @if (privacy.invalid && privacy.touched) {
            <span class="text-xs text-red-600 dark:text-red-400 block mt-1">{{ 'contact.form.validation.privacyRequired' | translate }}</span>
          }
        </div>
      </div>
      <div class="mt-4">
        <button [disabled]="isSubmitting" class="w-full md:w-auto min-w-[200px] cursor-pointer flex items-center justify-center rounded-lg h-12 px-6 bg-primary text-white text-base font-bold leading-normal tracking-wide shadow-md hover:bg-[#5a111a] hover:shadow-lg transition-all transform active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed"
          type="submit">
          @if (!isSubmitting) {
            <span>{{ 'contact.form.submit' | translate }}</span>
          }
          @if (isSubmitting) {
            <span>{{ 'contact.form.sending' | translate }}</span>
          }
        </button>
      </div>
    </form>
  </div>
</div>
